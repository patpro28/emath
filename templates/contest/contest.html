{% extends 'base.html' %}

{% block content_title %}
{% include 'title.html' %}
{% endblock content_title %}

{% block content_js %}
<script type="text/javascript">
  $(document).ready(function () {
      $('.time-remaining').each(function () {
          count_down($(this));
      });
  });
</script>
{% include "contest/media-js.html" %}
{% endblock content_js %}

{% block content %}
<div class="row">
    <div class="column">
        {% include 'contest/contest-list-tab.html' %}
        <div class="ui bottom attached segment">
          <h1 class="ui center aligned header">
            <a href="https://www.timeanddate.com/worldclock/fixedtime.html?msg={{ contest.name|urlquote('') }}&amp;iso=
                    {{- contest.start_time|utc|date('Y-m-d\TH:i:s') }}" class="date">
                {%- if contest.is_in_contest(request.user) and not request.participation.live -%}
                    {% if request.participation.spectate %}
                        {{- _('Spectating, contest ends in %(countdown)s.', countdown=contest.time_before_end|as_countdown) -}}
                    {% elif request.participation.end_time %}
                        {{- _('Participating virtually, %(countdown)s remaining.', countdown=request.participation.time_remaining|as_countdown) -}}
                    {% else %}
                        {{- _('Participating virtually.') -}}
                    {% endif %}
                {%- else -%}
                    {% if contest.start_time > now %}
                        {{- _('Starting in %(countdown)s', countdown=contest.time_before_start|as_countdown) -}}
                    {% elif contest.end_time < now %}
                        {{- _('Contest is over.') -}}
                    {% else %}
                        {%- if has_joined -%}
                            {% if live_participation.ended %}
                                {{- _('Your time is up! Contest ends in %(countdown)s.', countdown=contest.time_before_end|as_countdown) -}}
                            {% else %}
                                {{- _('You have %(countdown)s remaining.', countdown=live_participation.time_remaining|as_countdown) -}}
                            {% endif %}
                        {%- else -%}
                            {{ _('Contest ends in %(countdown)s.', countdown=contest.time_before_end|as_countdown) }}
                        {%- endif -%}
                    {% endif %}
                {%- endif -%}
            </a>
            <div class="sub header">
                {% if contest.time_limit %}
                    {% trans trimmed start_time=contest.start_time|date(_("F j, Y, G:i T")), end_time=contest.end_time|date(_("F j, Y, G:i T")), time_limit=contest.time_limit|timedelta('localized-no-seconds') %}
                        <b>{{ time_limit }}</b> window between <b>{{ start_time }}</b> and <b>{{ end_time }}</b>
                    {% endtrans %}
                {% else %}
                    {% trans trimmed length=contest.contest_window_length|timedelta("localized-no-seconds"), start_time=contest.start_time|date(_("F j, Y, G:i T")) %}
                        <b>{{ length }}</b> long starting on <b>{{ start_time }}</b>
                    {% endtrans %}
                {% endif %}
            </div>
          </h1>
          {% if contest.description %}
          <hr>
          {{ contest.description }}
          {% else %}
          {{ _('There is no information for this contest') }}
          {% endif %}
          {% if contest.is_in_contest(request.user) %}
          <hr>
          <div class="ui three column centered grid">
            <div class="column">
              <a href="{{ url('education:contest_task', contest.key) }}" class="fluid ui primary button">{{ _('Take a test') }}</a>
            </div>
          </div>
          {% endif %}
        </div>
    </div>
</div>
{% endblock content %}